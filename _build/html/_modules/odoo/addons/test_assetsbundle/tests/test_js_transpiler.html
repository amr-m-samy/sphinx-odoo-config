<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>odoo.addons.test_assetsbundle.tests.test_js_transpiler &mdash; Amr  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            Amr
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../modules.html">odoo</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Amr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../../../odoo.html">odoo</a></li>
      <li class="breadcrumb-item active">odoo.addons.test_assetsbundle.tests.test_js_transpiler</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for odoo.addons.test_assetsbundle.tests.test_js_transpiler</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># Part of Odoo. See LICENSE file for full copyright and licensing details.</span>

<span class="kn">from</span> <span class="nn">odoo.tests</span> <span class="kn">import</span> <span class="n">tagged</span>
<span class="kn">from</span> <span class="nn">odoo.tests.common</span> <span class="kn">import</span> <span class="n">TransactionCase</span>
<span class="kn">from</span> <span class="nn">odoo.tools</span> <span class="kn">import</span> <span class="n">transpile_javascript</span>


<div class="viewcode-block" id="TestJsTranspiler">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler">[docs]</a>
<span class="nd">@tagged</span><span class="p">(</span><span class="s1">&#39;post_install&#39;</span><span class="p">,</span> <span class="s1">&#39;-at_install&#39;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TestJsTranspiler</span><span class="p">(</span><span class="n">TransactionCase</span><span class="p">):</span>
    <span class="n">maxDiff</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="TestJsTranspiler.test_01_alias">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_01_alias">[docs]</a>
    <span class="k">def</span> <span class="nf">test_01_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;/** @odoo-module alias=test_assetsbundle.Alias **/&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">/** @odoo-module alias=test_assetsbundle.Alias **/</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>

<span class="s2">odoo.define(`test_assetsbundle.Alias`, [&#39;@test_assetsbundle/alias&#39;], function (require) {</span>
<span class="s2">                        return require(&#39;@test_assetsbundle/alias&#39;)[Symbol.for(&quot;default&quot;)];</span>
<span class="s2">                        });</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_02_default">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_02_default">[docs]</a>
    <span class="k">def</span> <span class="nf">test_02_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;/** @odoo-module alias=test_assetsbundle.Alias default=False **/&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">/** @odoo-module alias=test_assetsbundle.Alias default=False **/</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>

<span class="s2">odoo.define(`test_assetsbundle.Alias`, [&#39;@test_assetsbundle/alias&#39;], function (require) {</span>
<span class="s2">                        return require(&#39;@test_assetsbundle/alias&#39;);</span>
<span class="s2">                        });</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;/** @odoo-module alias=test_assetsbundle.Alias default=0 **/&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">/** @odoo-module alias=test_assetsbundle.Alias default=0 **/</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>

<span class="s2">odoo.define(`test_assetsbundle.Alias`, [&#39;@test_assetsbundle/alias&#39;], function (require) {</span>
<span class="s2">                        return require(&#39;@test_assetsbundle/alias&#39;);</span>
<span class="s2">                        });</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;/** @odoo-module alias=test_assetsbundle.Alias default=false **/&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">/** @odoo-module alias=test_assetsbundle.Alias default=false **/</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>

<span class="s2">odoo.define(`test_assetsbundle.Alias`, [&#39;@test_assetsbundle/alias&#39;], function (require) {</span>
<span class="s2">                        return require(&#39;@test_assetsbundle/alias&#39;);</span>
<span class="s2">                        });</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_03_classes">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_03_classes">[docs]</a>
    <span class="k">def</span> <span class="nf">test_03_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;export default class Nice </span><span class="si">{}</span>

<span class="s2">class Vehicule </span><span class="si">{}</span>

<span class="s2">export class Car extends Vehicule </span><span class="si">{}</span>

<span class="s2">export class Boat extends Vehicule </span><span class="si">{}</span>

<span class="s2">export const Ferrari = class Ferrari extends Car </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/classes.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/classes&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">const Nice = __exports[Symbol.for(&quot;default&quot;)] = class Nice </span><span class="si">{}</span>

<span class="s2">class Vehicule </span><span class="si">{}</span>

<span class="s2">const Car = __exports.Car = class Car extends Vehicule </span><span class="si">{}</span>

<span class="s2">const Boat = __exports.Boat = class Boat extends Vehicule </span><span class="si">{}</span>

<span class="s2">const Ferrari = __exports.Ferrari = class Ferrari extends Car </span><span class="si">{}</span><span class="s2">;</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_04_comments">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_04_comments">[docs]</a>
    <span class="k">def</span> <span class="nf">test_04_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;/**</span>
<span class="s2"> * This is a comment</span>
<span class="s2"> */</span>

<span class="s2">/**</span>
<span class="s2"> * This isn&#39;t a string</span>
<span class="s2"> */</span>
<span class="s2">export class Test {</span>
<span class="s2">  // This is a comment in a class</span>
<span class="s2">}</span>

<span class="s2">/* cool comment */ const a = 5; /* another cool comment */</span>

<span class="s2">const b = 5; // hello</span>

<span class="s2">// another one</span>

<span class="s2">const y = &quot;this is a /* nice string and should be kept */&quot;;</span>
<span class="s2">const z = &quot;this is a /* nice string and should be kept&quot;;</span>
<span class="s2">export const x = &quot;this is a // nice string and should be kept&quot;;</span>
<span class="s2">const w = &quot;this is a */ nice string and should be kept&quot;;</span>

<span class="s2">// This isn&#39;t a string</span>
<span class="s2">/*</span>
<span class="s2">  comments</span>
<span class="s2"> */</span>
<span class="s2">const aaa = &quot;keep!&quot;;</span>
<span class="s2">/*</span>
<span class="s2">  comments</span>
<span class="s2"> */</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/comments.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/comments&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">/**</span>
<span class="s2"> * This is a comment</span>
<span class="s2"> */</span>

<span class="s2">/**</span>
<span class="s2"> * This isn&#39;t a string</span>
<span class="s2"> */</span>
<span class="s2">const Test = __exports.Test = class Test {</span>
<span class="s2">  // This is a comment in a class</span>
<span class="s2">}</span>

<span class="s2">/* cool comment */ const a = 5; /* another cool comment */</span>

<span class="s2">const b = 5; // hello</span>

<span class="s2">// another one</span>

<span class="s2">const y = &quot;this is a /* nice string and should be kept */&quot;;</span>
<span class="s2">const z = &quot;this is a /* nice string and should be kept&quot;;</span>
<span class="s2">const x = __exports.x = &quot;this is a // nice string and should be kept&quot;;</span>
<span class="s2">const w = &quot;this is a */ nice string and should be kept&quot;;</span>

<span class="s2">// This isn&#39;t a string</span>
<span class="s2">/*</span>
<span class="s2">  comments</span>
<span class="s2"> */</span>
<span class="s2">const aaa = &quot;keep!&quot;;</span>
<span class="s2">/*</span>
<span class="s2">  comments</span>
<span class="s2"> */</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_05_functions">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_05_functions">[docs]</a>
    <span class="k">def</span> <span class="nf">test_05_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;export function sayHello() {</span>
<span class="s2">  console.log(&quot;Hello&quot;);</span>
<span class="s2">}</span>

<span class="s2">export function sayHelloWorld() {</span>
<span class="s2">  console.log(&quot;Hello world&quot;);</span>
<span class="s2">}</span>

<span class="s2">export async function sayAsyncHello() {</span>
<span class="s2">  console.log(&quot;Hello Async&quot;);</span>
<span class="s2">}</span>


<span class="s2">export default function sayHelloDefault() {</span>
<span class="s2">  console.log(&quot;Hello Default&quot;);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/functions.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/functions&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">__exports.sayHello = sayHello; function sayHello() {</span>
<span class="s2">  console.log(&quot;Hello&quot;);</span>
<span class="s2">}</span>

<span class="s2">__exports.sayHelloWorld = sayHelloWorld; function sayHelloWorld() {</span>
<span class="s2">  console.log(&quot;Hello world&quot;);</span>
<span class="s2">}</span>

<span class="s2">__exports.sayAsyncHello = sayAsyncHello; async function sayAsyncHello() {</span>
<span class="s2">  console.log(&quot;Hello Async&quot;);</span>
<span class="s2">}</span>


<span class="s2">__exports[Symbol.for(&quot;default&quot;)] = sayHelloDefault; function sayHelloDefault() {</span>
<span class="s2">  console.log(&quot;Hello Default&quot;);</span>
<span class="s2">}</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_06_import">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_06_import">[docs]</a>
    <span class="k">def</span> <span class="nf">test_06_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;/**</span>
<span class="s2"> * import { Dialog, Notification } from &quot;../src/Dialog&quot;;</span>
<span class="s2"> */</span>
<span class="s2">import { Line1 } from &quot;../src/Dialog&quot;;</span>
<span class="s2">import { Line2, Notification } from &quot;../src/Dialog&quot;;</span>
<span class="s2">import { Line3, Notification } from &quot;Dialog&quot;;</span>
<span class="s2">import { Line4, Notification } from &quot;@tests/Dialog&quot;;</span>
<span class="s2">import { Line5, Notification } from &quot;./Dialog&quot;;</span>
<span class="s2">import { Line6, Notification } from &#39;../src/Dialog&#39;</span>
<span class="s2">import Line7  from &quot;../src/Dialog&quot;;</span>
<span class="s2">import  Line8  from &#39;../src/Dialog&#39;;</span>

<span class="s2">import Line9  from &quot;test.Dialog&quot;;</span>
<span class="s2">import  { Line10, Notification }  from &#39;test.Dialog2&#39;;</span>

<span class="s2">import * as Line11 from &quot;test.Dialog&quot;;</span>
<span class="s2">import Default1, { Named1 } from &quot;legacy.module&quot;;</span>
<span class="s2">import Default1, { Named1 } from &quot;@new_module/file&quot;;</span>
<span class="s2">import Default1, {</span>
<span class="s2">    Named1,</span>
<span class="s2">} from &quot;@new_module/file&quot;;</span>
<span class="s2">import Default2, * as Star1 from &quot;test.Dialog&quot;;</span>
<span class="s2">import &quot;test.Dialog&quot;;</span>

<span class="s2">import Line12  from &quot;@test.Dialog&quot;; //HELLO</span>
<span class="s2">import </span><span class="si">{Line13}</span><span class="s2">  from &quot;@test.Dialog&quot; //HELLO</span>


<span class="s2">const test = `import { Line14, Notification } from &quot;../src/Dialog&quot;;`</span>

<span class="s2">import Line15 from &quot;test/Dialog&quot;;</span>
<span class="s2">import Line16 from &quot;test.Dialog.error&quot;;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/import.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/import&#39;, [&#39;@test_assetsbundle/Dialog&#39;, &#39;Dialog&#39;, &#39;@tests/Dialog&#39;, &#39;test.Dialog&#39;, &#39;test.Dialog2&#39;, &#39;legacy.module&#39;, &#39;@new_module/file&#39;, &#39;@test.Dialog&#39;, &#39;test/Dialog&#39;, &#39;test.Dialog.error&#39;], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">/**</span>
<span class="s2"> * import { Dialog, Notification } from &quot;../src/Dialog&quot;;</span>
<span class="s2"> */</span>
<span class="s2">const { Line1 } = require(&quot;@test_assetsbundle/Dialog&quot;);</span>
<span class="s2">const { Line2, Notification } = require(&quot;@test_assetsbundle/Dialog&quot;);</span>
<span class="s2">const { Line3, Notification } = require(&quot;Dialog&quot;);</span>
<span class="s2">const { Line4, Notification } = require(&quot;@tests/Dialog&quot;);</span>
<span class="s2">const { Line5, Notification } = require(&quot;@test_assetsbundle/Dialog&quot;);</span>
<span class="s2">const { Line6, Notification } = require(&quot;@test_assetsbundle/Dialog&quot;)</span>
<span class="s2">const Line7 = require(&quot;@test_assetsbundle/Dialog&quot;)[Symbol.for(&quot;default&quot;)];</span>
<span class="s2">const Line8 = require(&quot;@test_assetsbundle/Dialog&quot;)[Symbol.for(&quot;default&quot;)];</span>

<span class="s2">const Line9 = require(&quot;test.Dialog&quot;);</span>
<span class="s2">const { Line10, Notification } = require(&#39;test.Dialog2&#39;);</span>

<span class="s2">const Line11 = require(&quot;test.Dialog&quot;);</span>
<span class="s2">const Default1 = require(&quot;legacy.module&quot;);</span>
<span class="s2">const { Named1 } = Default1;</span>
<span class="s2">const { [Symbol.for(&quot;default&quot;)]: Default1, Named1 } = require(&quot;@new_module/file&quot;);</span>
<span class="s2">const { [Symbol.for(&quot;default&quot;)]: Default1,</span>
<span class="s2">    Named1,</span>
<span class="s2">} = require(&quot;@new_module/file&quot;);</span>
<span class="s2">const Star1 = require(&quot;test.Dialog&quot;);</span>
<span class="s2">const Default2 = Star1[Symbol.for(&quot;default&quot;)];</span>
<span class="s2">require(&quot;test.Dialog&quot;);</span>

<span class="s2">const Line12 = require(&quot;@test.Dialog&quot;)[Symbol.for(&quot;default&quot;)]; //HELLO</span>
<span class="s2">const </span><span class="si">{Line13}</span><span class="s2"> = require(&quot;@test.Dialog&quot;) //HELLO</span>


<span class="s2">const test = `import { Line14, Notification } from &quot;../src/Dialog&quot;;`</span>

<span class="s2">const Line15 = require(&quot;test/Dialog&quot;);</span>
<span class="s2">const Line16 = require(&quot;test.Dialog.error&quot;);</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_07_index">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_07_index">[docs]</a>
    <span class="k">def</span> <span class="nf">test_07_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;export const a = 5;</span>

<span class="s2">import * as b from &quot;@tests/dir&quot;;</span>

<span class="s2">import c from &quot;@tests/dir/index/&quot;;</span>

<span class="s2">import d from &quot;@tests&quot;;&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/index.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle&#39;, [&#39;@tests/dir&#39;, &#39;@tests&#39;], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">const a = __exports.a = 5;</span>

<span class="s2">const b = require(&quot;@tests/dir&quot;);</span>

<span class="s2">const c = require(&quot;@tests/dir&quot;)[Symbol.for(&quot;default&quot;)];</span>

<span class="s2">const d = require(&quot;@tests&quot;)[Symbol.for(&quot;default&quot;)];</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_08_list">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_08_list">[docs]</a>
    <span class="k">def</span> <span class="nf">test_08_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;export {a, b};</span>

<span class="s2">export {a as aa, b, c as cc};</span>
<span class="s2">export {a, aReallyVeryLongNameWithSomeExtra}</span>
<span class="s2">export {</span>
<span class="s2">        a,</span>
<span class="s2">        aReallyVeryLongNameWithSomeExtra,</span>
<span class="s2">        }</span>
<span class="s2">export {</span>
<span class="s2">        a,</span>
<span class="s2">        aReallyVeryLongNameWithSomeExtra</span>
<span class="s2">        }</span>


<span class="s2">export {a, aReallyVeryLongNameWithSomeExtra /* a comment must not cause catastrophic backtracking, even if not supported */};</span>

<span class="s2">export {c, d} from &quot;@tests/Dialog&quot;;</span>
<span class="s2">export </span><span class="si">{e}</span><span class="s2"> from &quot;../src/Dialog&quot;;</span>

<span class="s2">export {c as cc, d, e as ee} from &quot;@tests/Dialog&quot;;</span>

<span class="s2">export * from &quot;@tests/Dialog&quot;;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/list.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/list&#39;, [&#39;@tests/Dialog&#39;, &#39;@test_assetsbundle/Dialog&#39;], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">Object.assign(__exports, {a,  b});</span>

<span class="s2">Object.assign(__exports, {aa: a,  b, cc:  c});</span>
<span class="s2">Object.assign(__exports, {a,  aReallyVeryLongNameWithSomeExtra})</span>
<span class="s2">Object.assign(__exports, {</span>
<span class="s2">        a, </span>
<span class="s2">        aReallyVeryLongNameWithSomeExtra, </span>
<span class="s2">        })</span>
<span class="s2">Object.assign(__exports, {</span>
<span class="s2">        a, </span>
<span class="s2">        aReallyVeryLongNameWithSomeExtra</span>
<span class="s2">        })</span>


<span class="s2">export {a, aReallyVeryLongNameWithSomeExtra /* a comment must not cause catastrophic backtracking, even if not supported */};</span>

<span class="s2">{const {c, d} = require(&quot;@tests/Dialog&quot;);Object.assign(__exports, {c,  d})};</span>
<span class="s2">{const </span><span class="si">{e}</span><span class="s2"> = require(&quot;@test_assetsbundle/Dialog&quot;);Object.assign(__exports, </span><span class="si">{e}</span><span class="s2">)};</span>

<span class="s2">{const {c, d, e} = require(&quot;@tests/Dialog&quot;);Object.assign(__exports, {cc: c,  d, ee:  e})};</span>

<span class="s2">Object.assign(__exports, require(&quot;@tests/Dialog&quot;));</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>



<div class="viewcode-block" id="TestJsTranspiler.test_09_variables">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_09_variables">[docs]</a>
    <span class="k">def</span> <span class="nf">test_09_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;export const v = 5;</span>

<span class="s2">const a = 12;</span>
<span class="s2">const b = 15;</span>

<span class="s2">export { a, b };</span>

<span class="s2">export default 100;</span>

<span class="s2">export default a;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/variables.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/variables&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">const v = __exports.v = 5;</span>

<span class="s2">const a = 12;</span>
<span class="s2">const b = 15;</span>

<span class="s2">Object.assign(__exports, { a,  b });</span>

<span class="s2">__exports[Symbol.for(&quot;default&quot;)] = 100;</span>

<span class="s2">__exports[Symbol.for(&quot;default&quot;)] = a;</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_10_qunit_module_test">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_10_qunit_module_test">[docs]</a>
    <span class="k">def</span> <span class="nf">test_10_qunit_module_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;QUnit.test(&quot;Tests&quot;, function (assert) {{}})&quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/tests/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/../tests/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">QUnit.module(&quot;test_assetsbundle&quot;, function() {QUnit.test(&quot;Tests&quot;, function (assert) {{}})});</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_11_qunit_module_debug">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_11_qunit_module_debug">[docs]</a>
    <span class="k">def</span> <span class="nf">test_11_qunit_module_debug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;QUnit.debug(&quot;Tests&quot;, function (assert) {{}})&quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/tests/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/../tests/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">QUnit.module(&quot;test_assetsbundle&quot;, function() {QUnit.debug(&quot;Tests&quot;, function (assert) {{}})});</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_12_qunit_no_module">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_12_qunit_no_module">[docs]</a>
    <span class="k">def</span> <span class="nf">test_12_qunit_no_module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;let a = 1 + 1;&quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/tests/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/../tests/alias&#39;, [], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>
<span class="s2">let a = 1 + 1;</span>
<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestJsTranspiler.test_13_require_comment">
<a class="viewcode-back" href="../../../../../odoo.addons.test_assetsbundle.tests.html#odoo.addons.test_assetsbundle.tests.test_js_transpiler.TestJsTranspiler.test_13_require_comment">[docs]</a>
    <span class="k">def</span> <span class="nf">test_13_require_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">input_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">require(&quot;@test/Dialog&quot;)</span>
<span class="s2">const dialog = require(&quot;@test/Dialog2&quot;)</span>

<span class="s2">// require(&quot;@test/Comment&quot;)</span>
<span class="s2">// const comment = require(&quot;@test/Comment&quot;)</span>

<span class="s2">/*require(&quot;@test/Comment&quot;)*/</span>
<span class="s2">/* const comment = require(&quot;@test/Comment&quot;) */</span>

<span class="s2">/**</span>
<span class="s2">*require(&quot;@test/Comment&quot;)</span>
<span class="s2">*/</span>
<span class="s2">/**</span>
<span class="s2">* const comment = require(&quot;@test/Comment&quot;)</span>
<span class="s2">*/</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">transpile_javascript</span><span class="p">(</span><span class="s2">&quot;/test_assetsbundle/static/src/alias.js&quot;</span><span class="p">,</span> <span class="n">input_content</span><span class="p">)</span>

        <span class="n">expected_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;odoo.define(&#39;@test_assetsbundle/alias&#39;, [&#39;@test/Dialog&#39;, &#39;@test/Dialog2&#39;], function (require) {</span>
<span class="s2">&#39;use strict&#39;;</span>
<span class="s2">let __exports = </span><span class="si">{}</span><span class="s2">;</span>

<span class="s2">require(&quot;@test/Dialog&quot;)</span>
<span class="s2">const dialog = require(&quot;@test/Dialog2&quot;)</span>

<span class="s2">// require(&quot;@test/Comment&quot;)</span>
<span class="s2">// const comment = require(&quot;@test/Comment&quot;)</span>

<span class="s2">/*require(&quot;@test/Comment&quot;)*/</span>
<span class="s2">/* const comment = require(&quot;@test/Comment&quot;) */</span>

<span class="s2">/**</span>
<span class="s2">*require(&quot;@test/Comment&quot;)</span>
<span class="s2">*/</span>
<span class="s2">/**</span>
<span class="s2">* const comment = require(&quot;@test/Comment&quot;)</span>
<span class="s2">*/</span>

<span class="s2">return __exports;</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Amr.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>